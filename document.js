(()=>{const o=document,i=o.documentElement,n=o["body"],a=t=>o.createElement(t),r=t=>new Image,c=(t,e,o)=>t["on"+e]=o,s=t=>t.getBoundingClientRect();var t=(t,e=o)=>e.querySelector(t);const g=t(".set-level"),d=g.children[0],e=t("#countrys"),l=t=>{y.display=""},u={},p=t=>[...e.children],h=t=>p().map(t=>t.getAttribute("level")||"0"),v="world-ex-levels";const m=n.querySelector("svg"),y=g.style;c(e,"click",t=>{t.stopPropagation();var e=t["target"],o=s(e),l=e["id"],l=(u.target=e,u.id=l,d.innerHTML=l.replace("2",""),y.display="block",s(g)),e=e.getBBox(),r=m.getBBox(),i=s(m);Math.round(n.scrollLeft+o.left+o.width/2-l.width/2),Math.round(n.scrollTop+o.top+o.height/2-l.height/2),n.scrollTop,i.width;e.x,r.x;e.y,r.y,o=t.pageX+-l.width/2+n.scrollLeft,i=t.pageY+-l.height/2+n.scrollTop+4,y.left=o+"px",y.top=i+"px"}),c(o,"click",l);const b=t("#score"),w=t=>{var e=h().reduce((t,e)=>+t+(+e||0),0);b.innerHTML="分数: "+e};c(g,"click",t=>{t.stopPropagation();t=t.target.getAttribute("data-level");if(!t)return!1;u.target.setAttribute("level",t),w(),l(),localStorage.setItem(v,h().join(""))});{const M=localStorage.getItem(v)||"";p().forEach((t,e)=>{t.setAttribute("level",M[e]||"0")})}w(),setTimeout(t=>i.removeAttribute("data-loading"),2e3);const x=2560,f=2480,k=a("canvas"),L=(k.width=x,k.height=x,k.getContext("2d")),T=/weibo|qq/i.test(navigator.userAgent),A=t(".output"),B=A.style;const S=t(".about");c(t("#share-btn"),"click",function(){S.style.display="flex"}),c(t(".btn",S),"click",t=>{S.style.display="none"}),c(t("#save-btn"),"click",t=>{i.setAttribute("data-running","true");var e=(t=>{t=new Blob([t],{type:"image/svg+xml"});return URL.createObjectURL(t)})(`<?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2560 2480" width="2560px" height="2480px">${m.innerHTML}</svg>`);{var o=t=>{L.fillStyle="#56c5c1",L.fillRect(0,0,x,x),L.drawImage(t,0,0,x,f,0,40,x,f),k.toBlob(t=>{const r=URL.createObjectURL(t);A.querySelector("img").src=r,B.display="",setTimeout(t=>{var e,o,l;e=r,o=`[制霸南科]${Math.floor((+new Date-163e10)/1e4).toString(32)}.png`,l=a("a"),T||(l.download=o),l.href=e,l.click(),i.removeAttribute("data-running")},50)},"image/png")};const l=r();c(l,"load",t=>setTimeout(t=>o(l),500)),l.src=e}}),c(t("a",A),"click",t=>{B.display="none"})})();